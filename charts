# Import required libraries
import pandas as pd
import numpy as np
import plotly.graph_objects as go
from ipywidgets import interact, FloatSlider

# Sample data creation
dates = pd.date_range(start='2020-01-01', end='2023-01-01', freq='B')
stock1 = np.random.rand(len(dates))
stock2 = np.random.rand(len(dates))
stock3 = np.random.rand(len(dates))
sp500 = np.random.rand(len(dates))
eurostoxx = np.random.rand(len(dates))

data = pd.DataFrame({
    'Date': dates,
    'Stock1': stock1,
    'Stock2': stock2,
    'Stock3': stock3,
    'S&P500': sp500,
    'EUROSTOXX': eurostoxx
})

data.set_index('Date', inplace=True)

# Function to calculate rolling correlation
def rolling_correlation(stock, index, window):
    return data[stock].rolling(window).corr(data[index])

# Function to plot correlation
def plot_correlation(stock, index, window):
    correlation = rolling_correlation(stock, index, window)
    fig = go.Figure()
    fig.add_trace(go.Scatter(x=correlation.index, y=correlation, mode='lines', name=f'Correlation {stock} - {index}'))
    
    fig.update_layout(title=f'Rolling Correlation: {stock} with {index} (Window: {window})',
                      xaxis_title='Date',
                      yaxis_title='Correlation',
                      template='plotly_white')
    fig.show()

# Interactive widget
interact(plot_correlation, 
         stock=['Stock1', 'Stock2', 'Stock3'], 
         index=['S&P500', 'EUROSTOXX'], 
         window=FloatSlider(value=30, min=5, max=100, step=1, description='Rolling Window'));